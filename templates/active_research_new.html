{% extends "base.html" %}

{% block title %}Active Research{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/progress.css') }}">
{% endblock %}

{% block content %}
<section>
  <h2>Active Research</h2>
  <p>Monitor the progress of your ongoing research tasks.</p>
  
  <div class="active-jobs-list">
    {% if active_jobs %}
      {% for job in active_jobs %}
      <div class="active-job-card">
        <div class="job-info">
          <h3>{{ job.topic }}</h3>
          <div class="job-meta">
            {% if job.start_time %}
              <span><strong>Started:</strong> {{ job.start_time|timestamp_to_datetime }}</span> |
            {% endif %}
            <span><strong>Phase:</strong> {{ job.phase|title }}</span>
          </div>
          <div class="job-progress">
            <div class="progress-status">
              <span>{{ job.progress }}% Complete</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" style="width: {{ job.progress }}%;"></div>
            </div>
          </div>
        </div>
        <div class="job-actions">
          <a href="{{ url_for('progress_page', job_id=job.job_id) }}" class="button">View Progress</a>
        </div>
      </div>
      {% endfor %}
    {% else %}
      <div class="no-jobs-message">
        <p>No active research jobs at the moment.</p>
        <a href="{{ url_for('index') }}" class="button">Start New Research</a>
      </div>
    {% endif %}
  </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
  // Auto-refresh the page every 10 seconds
  document.addEventListener('DOMContentLoaded', function() {
    setTimeout(function() {
      location.reload();
    }, 10000);
  });
</script>
{% endblock %}
